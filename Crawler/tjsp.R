devtools::install_github("jjesusfilho/tjsp")

library(tjsp)
######################## download the htmls ###############################
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "filhos", inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "filhos", inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "filhos", inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "filhos", inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "guarda", inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "guarda", inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "guarda", inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "guarda", inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "alienação parental", aspas=TRUE,  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "alienação parental", aspas=TRUE,  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "alienação parental", aspas=TRUE,  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "alienação parental", aspas=TRUE,  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "divórcio",  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "divórcio",  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "divórcio",  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "divórcio",  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "pensão",  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "pensão",  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "pensão",  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "pensão",  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "bens",  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "bens",  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "bens",  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "bens",  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência doméstica", aspas=TRUE,  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência doméstica", aspas=TRUE,  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência doméstica", aspas=TRUE,  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência doméstica", aspas=TRUE,  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência contra a mulher", aspas=TRUE,  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência contra a mulher", aspas=TRUE,  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência contra a mulher", aspas=TRUE,  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "violência contra a mulher", aspas=TRUE,  inicio="01/01/2021", fim="31/08/2021")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "medida protetiva", aspas=TRUE,  inicio="01/01/2018", fim="31/12/2018")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "medida protetiva", aspas=TRUE,  inicio="01/01/2019", fim="31/12/2019")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "medida protetiva", aspas=TRUE,  inicio="01/01/2020", fim="31/12/2020")
tjsp_baixar_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana", livre = "medida protetiva", aspas=TRUE,  inicio="01/01/2021", fim="31/08/2021")

# After downloading the html pages the script sep_folders_script.sh should be run in order to avoid 
# RAM overflow
################################### Read the htmls into jsons ################################
library(jsonlite)
library(rvest)
# Read each subfolder
parent_folder = "/home/guilherme/Unicamp/Veritas/Downloads_Fabiana/Fabiana"
# List subfolders
sub_folders = list.dirs(parent_folder)[-1]
# Loop the subfolders htmls
for (i in seq_along(sub_folders)){
  print(sub_folders[i])
  jpg_table <- ler_cjpg(diretorio = sub_folders[i])
  json_table_jpg <- toJSON(jpg_table,pretty = TRUE)
  jpg_file <- file(paste("/home/guilherme/Unicamp/Veritas/Downloads_Fabiana_json/jpg",i,".json",sep=""))
  write(json_table_jpg,jpg_file)
  close(jpg_file)
}


#################################################2º grau####################################################################################
baixar_cjsg(diretorio = "/home/guilherme/Unicamp/IC_2021/Downloads", livre = "homofobia",inicio = "31/10/2018",fim = "30/10/2019")

jsg_table <- ler_cjpg(diretorio = "/home/guilherme/Unicamp/Veritas/Downloads")
#Lê inteiro teor

#links = paste("https://esaj.tjsp.jus.br/cjsg/getArquivo.do?cdAcordao=",jsg_table$cdacordao,"&cdForo=0",sep="")
#for (i in 1:nrow(jsg_table)){
#  link = paste("https://esaj.tjsp.jus.br/cjsg/getArquivo.do?cdAcordao=",jsg_table[i,10],"&cdForo=0",sep="")
#  html = read_html(link)
#}

json_table_jsg <- toJSON(jsg_table,pretty=TRUE)

jsg_file <- file("/home/guilherme/Unicamp/Veritas/padrao.json")
write(json_table_jsg,jsg_file)
close(jsg_file)

